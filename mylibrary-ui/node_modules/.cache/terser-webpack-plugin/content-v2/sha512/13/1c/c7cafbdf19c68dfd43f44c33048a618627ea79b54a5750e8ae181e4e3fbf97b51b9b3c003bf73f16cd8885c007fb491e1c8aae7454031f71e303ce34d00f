{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-a140ee78\"],{\"3f35\":function(t,e,a){},\"60fe\":function(t,e,a){\"use strict\";a.d(e,\"a\",(function(){return n}));var n=\"http://139.196.142.70:8090/mylibrary\"},\"7e1e\":function(t,e,a){\"use strict\";a.d(e,\"b\",(function(){return i})),a.d(e,\"e\",(function(){return r})),a.d(e,\"d\",(function(){return o})),a.d(e,\"f\",(function(){return s})),a.d(e,\"g\",(function(){return u})),a.d(e,\"c\",(function(){return c})),a.d(e,\"a\",(function(){return f}));var n=a(\"b775\"),l=a(\"60fe\");function i(t){return Object(n[\"a\"])({url:l[\"a\"]+\"/v2/book/\"+t.pageSize+\"/\"+t.currentPage,method:\"get\",params:t})}function r(t){return Object(n[\"a\"])({url:l[\"a\"]+\"/file/\"+t.pageSize+\"/\"+t.currentPage,method:\"get\",params:t})}function o(){return Object(n[\"a\"])({url:l[\"a\"]+\"/file/baseurl\",method:\"get\"})}function s(){return Object(n[\"a\"])({url:l[\"a\"]+\"/file/pdfviewer\",method:\"get\"})}function u(){return Object(n[\"a\"])({url:l[\"a\"]+\"/v2/book/publishhouse\"})}function c(){return Object(n[\"a\"])({url:l[\"a\"]+\"/v2/book/classification\"})}function f(){return Object(n[\"a\"])({url:l[\"a\"]+\"/v2/book/author\"})}},9162:function(t,e,a){\"use strict\";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"app-container\"},[a(\"el-form\",{staticClass:\"demo-form-inline\",attrs:{inline:!0}},[a(\"el-form-item\",{attrs:{label:\"名称\"}},[a(\"el-input\",{attrs:{placeholder:\"请输入内容\"},model:{value:t.bookName,callback:function(e){t.bookName=e},expression:\"bookName\"}})],1),t._v(\" \"),a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:function(e){return t.fetchData()}}},[t._v(\"搜索\")])],1)],1),t._v(\" \"),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],attrs:{data:t.list,\"element-loading-text\":\"Loading\",border:\"\",fit:\"\",\"highlight-current-row\":\"\"},on:{\"row-dblclick\":t.rowDblClick}},[a(\"el-table-column\",{attrs:{type:\"expand\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[a(\"el-form\",{staticClass:\"demo-table-expand\",attrs:{\"label-position\":\"left\",inline:\"\"}},[a(\"el-form-item\",{attrs:{label:\"文件大小\"}},[t._v(\"\\n                \"+t._s(e.row.filesize)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"文件路径\"}},[t._v(\"\\n                \"+t._s(e.row.filepath)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"文件时间\"}},[t._v(\"\\n                \"+t._s(e.row.filetime)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"根路径\"}},[t._v(\"\\n                \"+t._s(e.row.baseFilePath)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"id\"}},[t._v(\"\\n              \"+t._s(e.row.id)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"fileid\"}},[t._v(\"\\n              \"+t._s(e.row.fileid)+\"\\n            \")]),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"postid\"}},[t._v(\"\\n              \"+t._s(e.row.postid)+\"\\n            \")])],1)]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{align:\"center\",label:\"ID\",width:\"95\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.$index)+\"\\n        \")]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"书名\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.row.bookname)+\"\\n        \")]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"作者\",width:\"110\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[a(\"span\",[t._v(t._s(e.row.author))])]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"格式\",width:\"110\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.row.format)+\"\\n        \")]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"分类\",width:\"110\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.row.classification)+\"\\n        \")]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"标签\",width:\"80\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.row.tag)+\"\\n        \")]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{\"class-name\":\"status-col\",label:\"更新时间\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\"\\n          \"+t._s(e.row.updatetime)+\"\\n        \")]}}])})],1),t._v(\" \"),a(\"div\",{staticClass:\"block\"},[a(\"el-pagination\",{attrs:{\"current-page\":t.currentPage,\"page-sizes\":[15,30,45,60],\"page-size\":t.pageSize,layout:\"total, sizes, prev, pager, next, jumper\",total:t.total},on:{\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}})],1),t._v(\" \"),t.showDetail?a(\"detail\",{attrs:{row:t.clickedRow}}):t._e()],1)},l=[],i=a(\"7e1e\"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"el-dialog\",{staticStyle:{top:\"-100px\"},attrs:{title:\"详情\",visible:t.visible,width:\"100%\"},on:{\"update:visible\":function(e){t.visible=e}}},[a(\"el-row\",[a(\"el-col\",{attrs:{span:5}},[a(\"div\",{staticClass:\"grid-content bg-purple\"},[a(\"el-form\",{attrs:{model:t.form}},[a(\"el-form-item\",{attrs:{label:\"名称\",\"label-width\":t.formLabelWidth}},[a(\"el-input\",{attrs:{autocomplete:\"off\"},model:{value:t.data.bookname,callback:function(e){t.$set(t.data,\"bookname\",e)},expression:\"data.bookname\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"出版社\",\"label-width\":t.formLabelWidth}},[a(\"el-select\",{attrs:{filterable:\"\",\"allow-create\":\"\",placeholder:\"请选择\"},model:{value:t.data.publishhouse,callback:function(e){t.$set(t.data,\"publishhouse\",e)},expression:\"data.publishhouse\"}},t._l(t.publishhouse,(function(t){return a(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"出版时间\",\"label-width\":t.formLabelWidth}},[a(\"el-date-picker\",{attrs:{\"value-format\":\"yyyy-MM\",type:\"month\",placeholder:\"选择\"},model:{value:t.data.publishtime,callback:function(e){t.$set(t.data,\"publishtime\",e)},expression:\"data.publishtime\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"作者\",\"label-width\":t.formLabelWidth}},[a(\"el-select\",{attrs:{filterable:\"\",\"allow-create\":\"\",placeholder:\"请选择\"},model:{value:t.data.author,callback:function(e){t.$set(t.data,\"author\",e)},expression:\"data.author\"}},t._l(t.author,(function(t){return a(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"分类\",\"label-width\":t.formLabelWidth}},[a(\"el-select\",{attrs:{filterable:\"\",\"allow-create\":\"\",placeholder:\"请选择\"},model:{value:t.data.classification,callback:function(e){t.$set(t.data,\"classification\",e)},expression:\"data.classification\"}},t._l(t.classification,(function(t){return a(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"标签\",\"label-width\":t.formLabelWidth}},[t._l(t.tagArr,(function(e){return a(\"el-tag\",{key:e,attrs:{closable:\"\",\"disable-transitions\":!1},on:{close:function(a){return t.handleTagClose(e)}}},[t._v(\"\\n              \"+t._s(e)+\"\\n            \")])})),t._v(\" \"),t.inputVisible?a(\"el-input\",{ref:\"saveTagInput\",staticClass:\"input-new-tag\",attrs:{size:\"small\"},on:{blur:t.handleTagInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.handleTagInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:\"inputValue\"}}):a(\"el-button\",{staticClass:\"button-new-tag\",attrs:{size:\"small\"},on:{click:t.showTagInput}},[t._v(\"+ New Tag\")])],2),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"简介\",\"label-width\":t.formLabelWidth}},[a(\"el-input\",{attrs:{autocomplete:\"off\"},model:{value:t.data.brief,callback:function(e){t.$set(t.data,\"brief\",e)},expression:\"data.brief\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"评分\",\"label-width\":t.formLabelWidth}},[a(\"el-input\",{attrs:{autocomplete:\"off\"},model:{value:t.data.ratings,callback:function(e){t.$set(t.data,\"ratings\",e)},expression:\"data.ratings\"}})],1)],1)],1)]),t._v(\" \"),a(\"el-col\",{attrs:{span:13}},[a(\"el-row\",{staticStyle:{padding:\"0 20px\"}},[a(\"div\",{staticClass:\"grid-content bg-purple-light\"},[a(\"iframe\",{attrs:{width:\"100%\",height:\"600px\",src:t.pdfUrl}})])])],1),t._v(\" \"),a(\"el-col\",{attrs:{span:6}},[a(\"el-row\"),t._v(\" \"),a(\"el-row\",[t.refreshCarouselFlag?a(\"el-carousel\",{attrs:{interval:4e3,type:\"card\",height:\"280px\"}},t._l(t.imageUrls,(function(t){return a(\"el-carousel-item\",{key:t},[a(\"el-image\",{attrs:{src:t}})],1)})),1):t._e()],1),t._v(\" \"),a(\"el-row\",[a(\"el-col\",{attrs:{span:12}},[a(\"el-image\",{staticStyle:{height:\"300px\"},attrs:{src:t.coveraUrl,fit:\"scale-down\"}})],1),t._v(\" \"),a(\"el-col\",{attrs:{span:12}},[a(\"div\",{staticStyle:{\"margin-top\":\"20px\"}},[t._v(\"\\n\\n            生成\"),a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.cacheImageNumber,expression:\"cacheImageNumber\"}],attrs:{type:\"number\",min:\"0\",max:\"3\",value:\"0\",step:\"1\"},domProps:{value:t.cacheImageNumber},on:{input:function(e){e.target.composing||(t.cacheImageNumber=e.target.value)}}}),t._v(\"张缓存图片\"),a(\"el-button\",{on:{click:t.cacheImageHandler}},[t._v(\"do\")]),t._v(\" \"),a(\"br\"),t._v(\"\\n            设置第\"),a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.coverNo,expression:\"coverNo\"}],attrs:{type:\"number\",min:\"1\",max:\"3\",value:\"0\",step:\"1\"},domProps:{value:t.coverNo},on:{input:function(e){e.target.composing||(t.coverNo=e.target.value)}}}),t._v(\"张为封面\"),a(\"el-button\",{on:{click:function(e){return t.setCover()}}},[t._v(\"do\")]),t._v(\" \"),a(\"br\"),t._v(\" \"),a(\"el-button\",{on:{click:function(e){return t.deletePost()}}},[t._v(\"删除post\")]),a(\"el-button\",{on:{click:function(e){return t.setCoverToDefault()}}},[t._v(\"设置默认图片为封面\")])],1)])],1)],1)],1),t._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:function(e){t.visible=!1}}},[t._v(\"取 消\")]),t._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(e){return t.submit()}}},[t._v(\"确 定\")])],1)],1)},o=[],s=a(\"b775\"),u=a(\"60fe\");function c(t,e){return Object(s[\"a\"])({url:u[\"a\"]+\"/op/server/pdf/image/cache/\"+t+\"/\"+e,method:\"get\"})}function f(t){return Object(s[\"a\"])({url:u[\"a\"]+\"/book\",method:\"post\",data:t})}function d(t){return Object(s[\"a\"])({url:u[\"a\"]+\"/op/ghost/republish/\"+t,method:\"get\"})}function h(t){return Object(s[\"a\"])({url:u[\"a\"]+\"/op/ghost/deletePost/\"+t,method:\"delete\"})}var p={name:\"detail\",methods:{closeModal:function(){this.$parent.fetchData(),this.$parent.showDetail=!1},deletePost:function(){var t=this;h(this.data.postid).then((function(e){e.state?t.$notify({title:\"成功\",message:\"执行成功\",type:\"success\"}):t.$notify.error({title:\"失败\",message:\"执行失败\"+e.message})}))},submit:function(){var t=this;new Date;f(this.data).then((function(e){e.state?d(t.data.id).then((function(e){e.state?(t.$notify({title:\"成功\",message:\"执行成功\",type:\"success\"}),t.closeModal()):t.$notify.error({title:\"失败\",message:\"执行失败\"+e.message})})):t.$notify.error({title:\"失败\",message:\"执行失败\"+e.message})}))},setCover:function(t){var e,a=this;e=t||this.data.fileid+\"/\"+this.coverNo+\".jpg\",this.data.covera=e;var n={};n.id=this.data.id,n.covera=e,f(n).then((function(t){t.state?a.$notify({title:\"成功\",message:\"执行成功\",type:\"success\"}):a.$notify.error({title:\"失败\",message:\"执行失败\"+t.message})}))},setCoverToDefault:function(){var t=\"default/1.jpg\";this.setCover(t)},refreshCarousel:function(){var t=this;this.refreshCarouselFlag=!1,this.$nextTick((function(){t.refreshCarouselFlag=!0}))},cacheImageHandler:function(){var t=this,e=this.data.filepath;c(e,this.cacheImageNumber).then((function(e){e.state?(t.refreshCarousel(),t.$notify({title:\"成功\",message:\"执行成功\",type:\"success\"})):t.$notify.error({title:\"失败\",message:\"执行失败\"+e.message})}))},generateImageUrls:function(){var t=this.data.filepath.split(\".\")[0],e=this.fileBaseUrl+t;this.imageUrls.push(e+\"/1.jpg\"),this.imageUrls.push(e+\"/2.jpg\"),this.imageUrls.push(e+\"/3.jpg\"),this.coveraUrl=this.fileBaseUrl+this.data.covera},handleCurrentChange:function(t){this.currentRow=t},handleTagClose:function(t){this.tagArr.splice(this.tagArr.indexOf(t),1),this.data.tag=this.tagArr.join(\"/\")},showTagInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleTagInputConfirm:function(){var t=this.inputValue;t&&this.tagArr.indexOf(t)<0&&this.tagArr.push(t),this.inputVisible=!1,this.inputValue=\"\",this.data.tag=this.tagArr.join(\"/\")}},data:function(){return{form:{name:\"\",region:\"\",date1:\"\",date2:\"\",delivery:!1,type:[],resource:\"\",desc:\"\"},coveraUrl:\"\",coverNo:1,refreshCarouselFlag:!0,cacheImageNumber:3,input1Max:6,input1Min:0,input1Step:1,imageUrls:[],currentRow:null,inputVisible:!1,inputValue:\"\",formLabelWidth:\"120px\",visible:!0,data:this.row,pdfViewer:\"\",fileBaseUrl:\"\",classification:[],publishhouse:[],author:[]}},computed:{pdfUrl:function(){return this.pdfViewer+\"?file=\"+this.fileBaseUrl+this.data.filepath},tagArr:function(){return this.data.tag?this.data.tag.split(\"/\"):[]}},watch:{visible:function(t){this.$parent.showDetail=t,this.visible=!0},coverNo:function(t){var e=this.data.filepath.split(\".\")[0],a=this.fileBaseUrl+e;this.coveraUrl=a+\"/\"+t+\".jpg\"}},props:{row:{type:Object}},mounted:function(){var t=this;Object(i[\"d\"])().then((function(e){e.state&&(t.fileBaseUrl=e.data,t.generateImageUrls())})),Object(i[\"f\"])().then((function(e){e.state&&(t.pdfViewer=e.data)})),Object(i[\"c\"])().then((function(e){e.state&&(t.classification=e.data)})),Object(i[\"g\"])().then((function(e){e.state&&(t.publishhouse=e.data)})),this.author=Object(i[\"a\"])().then((function(e){e.state&&(t.author=e.data)}))}},m=p,b=(a(\"ea26\"),a(\"2877\")),v=Object(b[\"a\"])(m,r,o,!1,null,\"305b4e7f\",null),g=v.exports,_={name:\"book\",components:{detail:g},filters:{statusFilter:function(t){var e={published:\"success\",draft:\"gray\",deleted:\"danger\"};return e[t]}},data:function(){return{list:null,listLoading:!0,currentPage:1,pageSize:15,total:null,bookName:\"\",showDetail:!1,clickedRow:null}},created:function(){this.fetchData()},methods:{rowDblClick:function(t,e,a){console.log(t),this.showDetail=!0,this.clickedRow=t},fetchData:function(){var t=this;this.listLoading=!0,Object(i[\"b\"])({pageSize:this.pageSize,currentPage:this.currentPage,bookName:this.bookName}).then((function(e){t.list=e.data.items,t.total=e.data.count,t.listLoading=!1}))},handleSizeChange:function(t){this.pageSize=t,this.fetchData()},handleCurrentChange:function(t){this.currentPage=t,this.fetchData()}}},w=_,k=(a(\"a18b\"),Object(b[\"a\"])(w,n,l,!1,null,\"4e041d9e\",null));e[\"default\"]=k.exports},a18b:function(t,e,a){\"use strict\";var n=a(\"c6ad\"),l=a.n(n);l.a},c6ad:function(t,e,a){},ea26:function(t,e,a){\"use strict\";var n=a(\"3f35\"),l=a.n(n);l.a}}]);","extractedComments":[]}