{"remainingRequest":"/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/thread-loader/dist/cjs.js!/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/babel-loader/lib/index.js!/Users/weizhang/JAVASHOP/mylibrary-ui/src/statics/viewer/pdf/web/firefoxcom.js","dependencies":[{"path":"/Users/weizhang/JAVASHOP/mylibrary-ui/src/statics/viewer/pdf/web/firefoxcom.js","mtime":1577806166000},{"path":"/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/Users/weizhang/JAVASHOP/mylibrary-ui/node_modules/@babel/runtime/regenerator\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport '../extensions/firefox/tools/l10n';\nimport { createObjectURL, PDFDataRangeTransport, shadow } from 'pdfjs-dist';\nimport { BasePreferences } from './preferences';\nimport { DEFAULT_SCALE_VALUE } from './ui_utils';\nimport { PDFViewerApplication } from './app';\n\nif (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n  throw new Error('Module \"pdfjs-web/firefoxcom\" shall not be used outside ' + 'FIREFOX and MOZCENTRAL builds.');\n}\n\nvar FirefoxCom = function FirefoxComClosure() {\n  return {\n    /**\n     * Creates an event that the extension is listening for and will\n     * synchronously respond to.\n     * NOTE: It is reccomended to use request() instead since one day we may not\n     * be able to synchronously reply.\n     * @param {string} action - The action to trigger.\n     * @param {string} [data] - The data to send.\n     * @returns {*} The response.\n     */\n    requestSync: function requestSync(action, data) {\n      var request = document.createTextNode('');\n      document.documentElement.appendChild(request);\n      var sender = document.createEvent('CustomEvent');\n      sender.initCustomEvent('pdf.js.message', true, false, {\n        action: action,\n        data: data,\n        sync: true\n      });\n      request.dispatchEvent(sender);\n      var response = sender.detail.response;\n      document.documentElement.removeChild(request);\n      return response;\n    },\n\n    /**\n     * Creates an event that the extension is listening for and will\n     * asynchronously respond by calling the callback.\n     * @param {string} action - The action to trigger.\n     * @param {string} [data] - The data to send.\n     * @param {Function} [callback] - Response callback that will be called\n     *   with one data argument.\n     */\n    request: function request(action, data, callback) {\n      var request = document.createTextNode('');\n\n      if (callback) {\n        document.addEventListener('pdf.js.response', function listener(event) {\n          var node = event.target;\n          var response = event.detail.response;\n          document.documentElement.removeChild(node);\n          document.removeEventListener('pdf.js.response', listener);\n          return callback(response);\n        });\n      }\n\n      document.documentElement.appendChild(request);\n      var sender = document.createEvent('CustomEvent');\n      sender.initCustomEvent('pdf.js.message', true, false, {\n        action: action,\n        data: data,\n        sync: false,\n        responseExpected: !!callback\n      });\n      return request.dispatchEvent(sender);\n    }\n  };\n}();\n\nvar DownloadManager =\n/*#__PURE__*/\nfunction () {\n  function DownloadManager(options) {\n    _classCallCheck(this, DownloadManager);\n\n    this.disableCreateObjectURL = false;\n  }\n\n  _createClass(DownloadManager, [{\n    key: \"downloadUrl\",\n    value: function downloadUrl(url, filename) {\n      FirefoxCom.request('download', {\n        originalUrl: url,\n        filename: filename\n      });\n    }\n  }, {\n    key: \"downloadData\",\n    value: function downloadData(data, filename, contentType) {\n      var blobUrl = createObjectURL(data, contentType);\n      FirefoxCom.request('download', {\n        blobUrl: blobUrl,\n        originalUrl: blobUrl,\n        filename: filename,\n        isAttachment: true\n      });\n    }\n  }, {\n    key: \"download\",\n    value: function download(blob, url, filename) {\n      var _this = this;\n\n      var blobUrl = URL.createObjectURL(blob);\n\n      var onResponse = function onResponse(err) {\n        if (err && _this.onerror) {\n          _this.onerror(err);\n        }\n\n        URL.revokeObjectURL(blobUrl);\n      };\n\n      FirefoxCom.request('download', {\n        blobUrl: blobUrl,\n        originalUrl: url,\n        filename: filename\n      }, onResponse);\n    }\n  }]);\n\n  return DownloadManager;\n}();\n\nvar FirefoxPreferences =\n/*#__PURE__*/\nfunction (_BasePreferences) {\n  _inherits(FirefoxPreferences, _BasePreferences);\n\n  function FirefoxPreferences() {\n    _classCallCheck(this, FirefoxPreferences);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FirefoxPreferences).apply(this, arguments));\n  }\n\n  _createClass(FirefoxPreferences, [{\n    key: \"_writeToStorage\",\n    value: function () {\n      var _writeToStorage2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(prefObj) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", new Promise(function (resolve) {\n                  FirefoxCom.request('setPreferences', prefObj, resolve);\n                }));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function _writeToStorage(_x) {\n        return _writeToStorage2.apply(this, arguments);\n      }\n\n      return _writeToStorage;\n    }()\n  }, {\n    key: \"_readFromStorage\",\n    value: function () {\n      var _readFromStorage2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(prefObj) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", new Promise(function (resolve) {\n                  FirefoxCom.request('getPreferences', prefObj, function (prefStr) {\n                    var readPrefs = JSON.parse(prefStr);\n                    resolve(readPrefs);\n                  });\n                }));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function _readFromStorage(_x2) {\n        return _readFromStorage2.apply(this, arguments);\n      }\n\n      return _readFromStorage;\n    }()\n  }]);\n\n  return FirefoxPreferences;\n}(BasePreferences);\n\nvar MozL10n =\n/*#__PURE__*/\nfunction () {\n  function MozL10n(mozL10n) {\n    _classCallCheck(this, MozL10n);\n\n    this.mozL10n = mozL10n;\n  }\n\n  _createClass(MozL10n, [{\n    key: \"getLanguage\",\n    value: function () {\n      var _getLanguage = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", this.mozL10n.getLanguage());\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getLanguage() {\n        return _getLanguage.apply(this, arguments);\n      }\n\n      return getLanguage;\n    }()\n  }, {\n    key: \"getDirection\",\n    value: function () {\n      var _getDirection = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt(\"return\", this.mozL10n.getDirection());\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getDirection() {\n        return _getDirection.apply(this, arguments);\n      }\n\n      return getDirection;\n    }()\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(property, args, fallback) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", this.mozL10n.get(property, args, fallback));\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function get(_x3, _x4, _x5) {\n        return _get.apply(this, arguments);\n      }\n\n      return get;\n    }()\n  }, {\n    key: \"translate\",\n    value: function () {\n      var _translate = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(element) {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                this.mozL10n.translate(element);\n\n              case 1:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function translate(_x6) {\n        return _translate.apply(this, arguments);\n      }\n\n      return translate;\n    }()\n  }]);\n\n  return MozL10n;\n}();\n\n(function listenFindEvents() {\n  var events = ['find', 'findagain', 'findhighlightallchange', 'findcasesensitivitychange', 'findentirewordchange', 'findbarclose'];\n\n  var handleEvent = function handleEvent(_ref) {\n    var type = _ref.type,\n        detail = _ref.detail;\n\n    if (!PDFViewerApplication.initialized) {\n      return;\n    }\n\n    if (type === 'findbarclose') {\n      PDFViewerApplication.eventBus.dispatch(type, {\n        source: window\n      });\n      return;\n    }\n\n    PDFViewerApplication.eventBus.dispatch('find', {\n      source: window,\n      type: type.substring('find'.length),\n      query: detail.query,\n      phraseSearch: true,\n      caseSensitive: !!detail.caseSensitive,\n      entireWord: !!detail.entireWord,\n      highlightAll: !!detail.highlightAll,\n      findPrevious: !!detail.findPrevious\n    });\n  };\n\n  for (var _i = 0, _events = events; _i < _events.length; _i++) {\n    var event = _events[_i];\n    window.addEventListener(event, handleEvent);\n  }\n})();\n\n(function listenZoomEvents() {\n  var events = ['zoomin', 'zoomout', 'zoomreset'];\n\n  var handleEvent = function handleEvent(_ref2) {\n    var type = _ref2.type,\n        detail = _ref2.detail;\n\n    if (!PDFViewerApplication.initialized) {\n      return;\n    } // Avoid attempting to needlessly reset the zoom level *twice* in a row,\n    // when using the `Ctrl + 0` keyboard shortcut.\n\n\n    if (type === 'zoomreset' && // eslint-disable-next-line max-len\n    PDFViewerApplication.pdfViewer.currentScaleValue === DEFAULT_SCALE_VALUE) {\n      return;\n    }\n\n    PDFViewerApplication.eventBus.dispatch(type, {\n      source: window\n    });\n  };\n\n  for (var _i2 = 0, _events2 = events; _i2 < _events2.length; _i2++) {\n    var event = _events2[_i2];\n    window.addEventListener(event, handleEvent);\n  }\n})();\n\nvar FirefoxComDataRangeTransport =\n/*#__PURE__*/\nfunction (_PDFDataRangeTranspor) {\n  _inherits(FirefoxComDataRangeTransport, _PDFDataRangeTranspor);\n\n  function FirefoxComDataRangeTransport() {\n    _classCallCheck(this, FirefoxComDataRangeTransport);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FirefoxComDataRangeTransport).apply(this, arguments));\n  }\n\n  _createClass(FirefoxComDataRangeTransport, [{\n    key: \"requestDataRange\",\n    value: function requestDataRange(begin, end) {\n      FirefoxCom.request('requestDataRange', {\n        begin: begin,\n        end: end\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      // Sync call to ensure abort is really started.\n      FirefoxCom.requestSync('abortLoading', null);\n    }\n  }]);\n\n  return FirefoxComDataRangeTransport;\n}(PDFDataRangeTransport);\n\nPDFViewerApplication.externalServices = {\n  updateFindControlState: function updateFindControlState(data) {\n    FirefoxCom.request('updateFindControlState', data);\n  },\n  updateFindMatchesCount: function updateFindMatchesCount(data) {\n    FirefoxCom.request('updateFindMatchesCount', data);\n  },\n  initPassiveLoading: function initPassiveLoading(callbacks) {\n    var pdfDataRangeTransport;\n    window.addEventListener('message', function windowMessage(e) {\n      if (e.source !== null) {\n        // The message MUST originate from Chrome code.\n        console.warn('Rejected untrusted message from ' + e.origin);\n        return;\n      }\n\n      var args = e.data;\n\n      if (_typeof(args) !== 'object' || !('pdfjsLoadAction' in args)) {\n        return;\n      }\n\n      switch (args.pdfjsLoadAction) {\n        case 'supportsRangedLoading':\n          pdfDataRangeTransport = new FirefoxComDataRangeTransport(args.length, args.data, args.done);\n          callbacks.onOpenWithTransport(args.pdfUrl, args.length, pdfDataRangeTransport);\n          break;\n\n        case 'range':\n          pdfDataRangeTransport.onDataRange(args.begin, args.chunk);\n          break;\n\n        case 'rangeProgress':\n          pdfDataRangeTransport.onDataProgress(args.loaded);\n          break;\n\n        case 'progressiveRead':\n          pdfDataRangeTransport.onDataProgressiveRead(args.chunk); // Don't forget to report loading progress as well, since otherwise\n          // the loadingBar won't update when `disableRange=true` is set.\n\n          pdfDataRangeTransport.onDataProgress(args.loaded, args.total);\n          break;\n\n        case 'progressiveDone':\n          if (pdfDataRangeTransport) {\n            pdfDataRangeTransport.onDataProgressiveDone();\n          }\n\n          break;\n\n        case 'progress':\n          callbacks.onProgress(args.loaded, args.total);\n          break;\n\n        case 'complete':\n          if (!args.data) {\n            callbacks.onError(args.errorCode);\n            break;\n          }\n\n          callbacks.onOpenWithData(args.data);\n          break;\n      }\n    });\n    FirefoxCom.requestSync('initPassiveLoading', null);\n  },\n  fallback: function fallback(data, callback) {\n    FirefoxCom.request('fallback', data, callback);\n  },\n  reportTelemetry: function reportTelemetry(data) {\n    FirefoxCom.request('reportTelemetry', JSON.stringify(data));\n  },\n  createDownloadManager: function createDownloadManager(options) {\n    return new DownloadManager(options);\n  },\n  createPreferences: function createPreferences() {\n    return new FirefoxPreferences();\n  },\n  createL10n: function createL10n(options) {\n    var mozL10n = document.mozL10n; // TODO refactor mozL10n.setExternalLocalizerServices\n\n    return new MozL10n(mozL10n);\n  },\n\n  get supportsIntegratedFind() {\n    var support = FirefoxCom.requestSync('supportsIntegratedFind');\n    return shadow(this, 'supportsIntegratedFind', support);\n  },\n\n  get supportsDocumentFonts() {\n    var support = FirefoxCom.requestSync('supportsDocumentFonts');\n    return shadow(this, 'supportsDocumentFonts', support);\n  },\n\n  get supportsDocumentColors() {\n    var support = FirefoxCom.requestSync('supportsDocumentColors');\n    return shadow(this, 'supportsDocumentColors', support);\n  },\n\n  get supportedMouseWheelZoomModifierKeys() {\n    var support = FirefoxCom.requestSync('supportedMouseWheelZoomModifierKeys');\n    return shadow(this, 'supportedMouseWheelZoomModifierKeys', support);\n  }\n\n}; // l10n.js for Firefox extension expects services to be set.\n\ndocument.mozL10n.setExternalLocalizerServices({\n  getLocale: function getLocale() {\n    return FirefoxCom.requestSync('getLocale', null);\n  },\n  getStrings: function getStrings(key) {\n    return FirefoxCom.requestSync('getStrings', key);\n  }\n});\nexport { DownloadManager, FirefoxCom };",null]}